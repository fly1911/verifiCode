function jmGraph(i,s,t){if("function"==typeof s&&(t=s,s={}),s=s||{},!(this instanceof jmGraph))return new Promise(function(e,t){jmGraphTypeInit(s,function(){var t=new jmGraph(i,s);e&&e(t)})});if(this.type="jmGraph",this.option=s||{},this.util=jmUtils,"undefined"!=typeof wx&&wx.createCanvasContext)this.context=wx.createCanvasContext(i),i=wx.createSelectorQuery().select("#"+i);else{if("string"==typeof i&&"undefined"!=typeof document?i=document.getElementById(i):i.length&&(i=i[0]),"CANVAS"!=i.tagName){var e=document.createElement("canvas");i.appendChild(e),e.width=i.offsetWidth||i.clientWidth,e.height=i.offsetHeight||i.clientHeight,i=e}this.context=i.getContext("2d")}this.canvas=i,jmGraphTypeInit.call(this,s,function(){this.init(t)})}function jmGraphTypeInit(t,e){var c=jmGraph.prototype.shapes=jmGraph.prototype.shapes||{},m=t.baseUrl||"";var i=this;!function e(i,s){if("undefined"!=typeof wx&&wx.createCanvasContext)s&&s(1);else{if(!m)for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var o=t[n].src,r=o.indexOf("jmGraph");if(0<=r){m=o.substring(0,r);break}}if(i){var h=i;if(i.length&&(h=i[0]),h.url&&h.typeName){if(c[h.name]||void 0!==window[h.typeName])return h.name&&!c[h.name]&&void 0!==window[h.typeName]&&(c[h.name]=window[h.typeName]),void e(i.slice(1),s);var a=m+h.url;(t=document.createElement("script")).type="text/javascript",t.charset="utf-8",t.src=a;var l=document.getElementsByTagName("head")[0];function p(t){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(h.name&&void 0!==window[h.typeName]&&(c[h.name]=window[h.typeName]),e(i.slice(1),s))}return l.appendChild(t),t.readyState?t.onreadystatechange=p:t.onload=p,void(t.onerror=function(){l.removeChild(t),console.error&&console.error(this.src+" load failure"),s&&s(0)})}}s&&s(1)}}([{typeName:"jmUtils",url:"common/jmUtils.js"},{typeName:"jmGradient",url:"models/jmGradient.js"},{typeName:"jmShadow",url:"models/jmShadow.js"},{typeName:"jmObject",url:"common/jmObject.js"},{typeName:"jmProperty",url:"common/jmProperty.js"},{typeName:"jmEvents",url:"common/jmEvents.js"},{typeName:"jmControl",url:"common/jmControl.js"},{typeName:"jmShape",url:"shapes/jmShape.js"},{name:"path",typeName:"jmPath",url:"shapes/jmPath.js"},{name:"line",typeName:"jmLine",url:"shapes/jmLine.js"},{name:"arc",typeName:"jmArc",url:"shapes/jmArc.js"},{name:"circle",typeName:"jmCircle",url:"shapes/jmCircle.js"},{name:"harc",typeName:"jmHArc",url:"shapes/jmHArc.js"},{name:"prismatic",typeName:"jmPrismatic",url:"shapes/jmPrismatic.js"},{name:"bezier",typeName:"jmBezier",url:"shapes/jmBezier.js"},{name:"rect",typeName:"jmRect",url:"shapes/jmRect.js"},{name:"arraw",typeName:"jmArraw",url:"shapes/jmArraw.js"},{name:"label",typeName:"jmLabel",url:"controls/jmLabel.js"},{name:"image",typeName:"jmImage",url:"controls/jmImage.js"},{name:"resize",typeName:"jmResize",url:"controls/jmResize.js"},{name:"arrawline",typeName:"jmArrawLine",url:"controls/jmArrawLine.js"}],function(t){jmGraph.superClass||(jmUtils.extend(jmGraph,jmControl),i&&"jmGraph"==i.type&&(i.__proto__.__proto__=new jmControl)),e&&e.call(i)})}function jmGradient(t){if(this.stops=new jmUtils.list,t&&"object"==typeof t)for(var e in t)this[e]=t[e];else"string"==typeof t&&this.fromString(t)}function jmShadow(t,e,i,s){"string"!=typeof t||e||i||s?(this.x=t,this.y=e,this.blur=i,this.color=s):this.fromString(t)}jmGraph.prototype.init=function(t){this.on("beginDraw",function(){this.context.translate(.5,.5)}),this.on("endDraw",function(){this.context.translate(-.5,-.5)}),0<this.option.width&&(this.width=this.option.width),0<this.option.height&&(this.height=this.option.height),this.eventHandler=new jmEvents(this,this.canvas.canvas||this.canvas),this.initializing(this.context,this.option.style),t&&t(this)},jmGraph.prototype.shapes={},jmGraph.prototype.getPosition=function(){var t=jmUtils.getElementPosition(this.canvas.canvas||this.canvas);return t.width=this.canvas.width,t.height=this.canvas.height,t.right=t.left+t.width,t.bottom=t.top+t.height,t},jmGraph.prototype.registerShape=function(t,e){this.shapes[t]=e},jmGraph.prototype.createShape=function(t,e){var i=this.shapes[t];if(i)return e||(e={}),new i(this,e)},jmGraph.prototype.isSupportedBrowser=function(){var t=jmUtils.browser();return!t.msie||8<t.ver},jmGraph.prototype.createShadow=function(t,e,i,s){return new jmShadow(t,e,i,s)},jmGraph.prototype.createLinearGradient=function(t,e,i,s){return new jmGradient({type:"linear",x1:t,y1:e,x2:i,y2:s})},jmGraph.prototype.createRadialGradient=function(t,e,i,s,n,o){return new jmGradient({type:"radial",x1:t,y1:e,r1:i,x2:s,y2:n,r2:o})},jmGraph.prototype.refresh=function(){this.redraw()},jmGraph.prototype.redraw=function(t,e){this.clear(t,e),this.paint()},jmGraph.prototype.clear=function(t,e){t&&e?(this.canvas.width=t,this.canvas.height=e,this.scaleSize&&this.context.scale&&this.context.scale(this.scaleSize.x,this.scaleSize.y)):(t=this.canvas.width,e=this.canvas.height,this.scaleSize&&(t/=this.scaleSize.x,e/=this.scaleSize.y)),this.style&&this.style.fill?this.points=[{x:0,y:0},{x:t,y:0},{x:t,y:e},{x:0,y:e}]:this.context.clearRect&&this.context.clearRect(0,0,t,e)},jmGraph.prototype.css=function(t,e){this.canvas&&(this.canvas.style[t]=e)},jmGraph.prototype.createPath=function(t,e){return this.createShape("path",{points:t,style:e})},jmGraph.prototype.createLine=function(t,e,i){return this.createShape("line",{start:t,end:e,style:i})},jmGraph.prototype.zoomOut=function(){this.scale(.9,.9)},jmGraph.prototype.zoomIn=function(){this.scale(1.1,1.1)},jmGraph.prototype.zoomActual=function(){this.scaleSize?this.scale(1/this.scaleSize.x,1/this.scaleSize.y):this.scale(1,1)},jmGraph.prototype.scale=function(t,e){this.normalSize||(this.normalSize={width:this.canvas.width,height:this.canvas.height}),this.context.scale(t,e),this.scaleSize?this.scaleSize={x:t*this.scaleSize.x,y:e*this.scaleSize.y}:this.scaleSize={x:t,y:e},this.refresh()},jmGraph.prototype.toDataURL=function(){return this.canvas.toDataURL?this.canvas.toDataURL():""},jmGraph.prototype.autoRefresh=function(e){var i=this;return function t(){i.needUpdate&&i.redraw(),requestAnimationFrame(t),e&&e()}(),this},"undefined"!=typeof module&&(module.exports=jmGraph),jmGradient.prototype.addColorStop=jmGradient.prototype.addStop=function(t,e){this.stops.add({offset:t,color:e})},jmGradient.prototype.toGradient=function(t){var s,e=t.context||t,i=t.absoluteBounds?t.absoluteBounds:t.getAbsoluteBounds(),n=this.x1||0,o=this.y1||0,r=this.x2,h=this.y2,a=t.getLocation(),l=0;a.radius&&(l=2*a.radius),l||(l=Math.min(a.width,a.height)),jmUtils.checkPercent(n)&&(n=jmUtils.percentToNumber(n)*(a.width||l)),jmUtils.checkPercent(r)&&(r=jmUtils.percentToNumber(r)*(a.width||l)),jmUtils.checkPercent(o)&&(o=jmUtils.percentToNumber(o)*(a.height||l)),jmUtils.checkPercent(h)&&(h=jmUtils.percentToNumber(h)*(a.height||l));var p=Number(n)+i.left,c=Number(o)+i.top,m=Number(r)+i.left,u=Number(h)+i.top;if("linear"===this.type)s=e.createLinearGradient(p,c,m,u);else if("radial"===this.type){var f=this.r1||0,d=this.r2;jmUtils.checkPercent(f)&&(f=jmUtils.percentToNumber(f),f*=l),jmUtils.checkPercent(d)&&(d=jmUtils.percentToNumber(d),d*=l),s=e.createCircularGradient?e.createCircularGradient(p,c,d):e.createRadialGradient(p,c,f,m,u,d)}return this.stops.each(function(t,e){var i=jmUtils.toColor(e.color);s.addColorStop(e.offset,i)}),s},jmGradient.prototype.fromString=function(t){if(t){var e=t.match(/(linear|radial)-gradient\s*\(\s*([^,]+[^\)]+)\)/i);if(e&&!(e.length<3)){this.type=e[1].toLowerCase();var i=e[2].split(",");if(i.length){var s=jmUtils.trim(i[0]).split(/\s+/);if("linear"==this.type?s.length<=2?(this.x2=s[0],this.y2=s[1]||0):(this.x1=s[0],this.y1=s[1],this.x2=s[2],this.y2=s[3]):s.length<=3?(this.x2=s[0],this.y2=s[1]||0,this.r2=s[2]||0):(this.x1=s[0],this.y1=s[1],this.r1=s[2],this.x2=s[3],this.y2=s[3],this.r2=s[3]),1<i.length)for(var n=1;n<i.length;n++){var o=jmUtils.trim(i[n]).split(/\s+/);o.length&&this.addStop(o[1]||0,o[0])}}}}},jmGradient.prototype.toString=function(){var i=this.type+"-gradient(";return"linear"==this.type?i+=this.x1+" "+this.y1+" "+this.x2+" "+this.y2:i+=this.x1+" "+this.y1+" "+this.r1+" "+this.x2+" "+this.y2+" "+this.r2,this.stops.each(function(t,e){i+=","+e.color+" "+e.offset}),i+")"},jmShadow.prototype.fromString=function(t){var e=t.match(/\s*([^,]+)\s*,\s*([^,]+)\s*(,[^,]+)?\s*(,[\s\S]+)?\s*/i);e&&(this.x=e[1]||0,this.y=e[2]||0,e[3]&&(e[3]=jmUtils.trim(e[3],", "),0===e[3].indexOf("#")||/^rgb/i.test(e[3])?this.color=e[3]:this.blur=jmUtils.trim(e[3],", ")),e[4]&&(this.color=jmUtils.trim(e[4],", ")))},jmShadow.prototype.toString=function(t){t=this.x+","+this.y;return this.blur&&(t+=","+this.blur),this.color&&(t+=","+this.color),t};var jmUtils={version:"1.0.0"};function jmEvents(e,i){var n=this;this.mouseHandler=new function(s,t){this.container=s,this.target=t||s,this.init=function(){var i=this.target,t="undefined"!=typeof document;jmUtils.bindEvent(this.target,"mousedown",function(t){t=t||window.event;s.raiseEvent("mousedown",t)}),t&&jmUtils.bindEvent(document,"mousemove",function(t){var e=(t=t||window.event).target||t.srcElement;if(e==i){s.raiseEvent("mousemove",t);return t.preventDefault&&t.preventDefault(),!1}}),jmUtils.bindEvent(this.target,"mouseover",function(t){t=t||window.event,s.raiseEvent("mouseover",t)}),jmUtils.bindEvent(this.target,"mouseleave",function(t){t=t||window.event,s.raiseEvent("mouseleave",t)}),jmUtils.bindEvent(this.target,"mouseout",function(t){t=t||window.event,s.raiseEvent("mouseout",t)}),t&&jmUtils.bindEvent(document,"mouseup",function(t){t=t||window.event;var e=s.raiseEvent("mouseup",t);if(!1===e)return t.preventDefault&&t.preventDefault(),!1}),jmUtils.bindEvent(this.target,"dblclick",function(t){t=t||window.event,s.raiseEvent("dblclick",t)}),jmUtils.bindEvent(this.target,"click",function(t){t=t||window.event,s.raiseEvent("click",t)}),t&&jmUtils.bindEvent(document,"resize",function(t){return t=t||window.event,s.raiseEvent("resize",t)}),t&&jmUtils.bindEvent(document,"touchstart",function(t){return n.touchStart.call(this,t)},{passive:!1}),t&&jmUtils.bindEvent(document,"touchmove",function(t){return n.touchMove.call(this,t)},{passive:!1}),t&&jmUtils.bindEvent(document,"touchend",function(t){return n.touchEnd.call(this,t)},{passive:!1}),t&&jmUtils.bindEvent(document,"touchcancel",function(t){return n.touchCancel.call(this,t)},{passive:!1})},this.init()}(e,i),this.keyHandler=new function(i,t){function s(t){var e=t.srcElement||t.target;return!e||"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName&&"ANCHOR"!=e.tagName&&"FORM"!=e.tagName&&"FILE"!=e.tagName&&"IMG"!=e.tagName&&"HIDDEN"!=e.tagName&&"RADIO"!=e.tagName&&"TEXT"!=e.tagName}this.container=i,this.target=t||i,this.init=function(){var t="undefined"!=typeof document;t&&jmUtils.bindEvent(document,"keypress",function(t){if(s(t=t||window.event)){var e=i.raiseEvent("keypress",t);return!1===e&&t.preventDefault&&t.preventDefault(),e}}),t&&jmUtils.bindEvent(document,"keydown",function(t){if(s(t=t||window.event)){var e=i.raiseEvent("keydown",t);return!1===e&&t.preventDefault&&t.preventDefault(),e}}),t&&jmUtils.bindEvent(document,"keyup",function(t){if(s(t=t||window.event)){var e=i.raiseEvent("keyup",t);return!1===e&&t.preventDefault&&t.preventDefault(),e}})},this.init()}(e,i),this.touchStart=function(t){if(t=t||window.event,e.raiseEvent("touchstart",t),(t.target||t.srcElement)==i)return t.preventDefault&&t.preventDefault(),!1},this.touchMove=function(t){if(t=t||window.event,e.raiseEvent("touchmove",t),(t.target||t.srcElement)==i)return t.preventDefault&&t.preventDefault(),!1},this.touchEnd=function(t){if(t=t||window.event,e.raiseEvent("touchend",t),(t.target||t.srcElement)==i)return t.preventDefault&&t.preventDefault(),!1},this.touchCancel=function(t){if(t=t||window.event,e.raiseEvent("touchcancel",t),(t.target||t.srcElement)==i)return t.preventDefault&&t.preventDefault(),!1}}function jmObject(t){t&&"jmGraph"==t.type&&(this.graph=t)}jmUtils.extend=function(t,e){if("function"==typeof e){var i=function(){};i.prototype=e.prototype;var s=t.prototype;s&&s.constructor!=Object&&jmUtils.extend(i,s),t.prototype=new i,(t.prototype.constructor=t).superClass=e}else{if("object"!=typeof e)throw new Error('fatal error:"Function.prototype.extend" expects a function or object');var n="function"==typeof t?t.prototype:t;for(var o in e)void 0===n[o]&&(n[o]=e[o]);n._base=e}return t},jmUtils.clone=function(t,e){if(t&&"object"==typeof t){if(jmUtils.isType(t,jmUtils.list))return new jmUtils.list(t.items);if(jmUtils.isArray(t)){if(e){for(var i=[],s=0;s<t.length;s++)i.push(jmUtils.clone(t[s]));return i}return t.slice(0)}var n={};for(var o in n.constructor=t.constructor,t)n[o]=jmUtils.clone(t[o]);return n}return t},jmUtils.apply=function(t,e){if("object"==typeof t&&"object"==typeof e)for(var i in t){var s=typeof t[i];"function"!=s&&("object"==s?(e[i]&&"object"==typeof e[i]||(e[i]={}),this.apply(t[i],e[i])):e[i]=t[i])}},jmUtils.list=function(){function t(t){this.items=[],this.option={},t&&(jmUtils.isArray(t)?this.items=t.slice(0):this.option=t||{})}return t.prototype.add=function(t){if(t&&jmUtils.isArray(t)){for(var e in t)arguments.callee.call(this,t[e]);return t}return"object"==typeof t&&this.contain(t)||(this.items.push(t),this.option.addHandler&&this.option.addHandler.call(this,t)),t},t.prototype.remove=function(t){for(var e=this.items.length-1;0<=e;e--)this.items[e]==t&&this.removeAt(e)},t.prototype.removeAt=function(t){if(this.items.length>t){var e=this.items[t];this.items.splice(t,1),this.option.removeHandler&&this.option.removeHandler.call(this,e,t)}},t.prototype.contain=function(t){for(var e in this.items)if(this.items[e]==t)return!0;return!1},t.prototype.get=function(t){if("function"!=typeof t)return this.items[t];for(var e in this.items)if(t(this.items[e]))return this.items[e]},t.prototype.each=function(t,e){if(t&&"function"==typeof t)if(e)for(var i=this.items.length-1;0<=i;i--){if(!1===t.call(this,i,this.items[i]))break}else{var s=this.items.length;for(i=0;i<s;i++){if(!1===t.call(this,i,this.items[i]))break}}},t.prototype.sort=function(t){this.items.sort(t)},t.prototype.count=function(t){if(t&&"function"==typeof t){for(var e=0,i=this.items.length,s=0;s<i;s++)t(this.items[s])&&e++;return e}return this.items.length},t.prototype.clear=function(){for(var t=this.items.length-1;0<=t;t--)this.remove(this.items[t])},t}(),jmUtils.cache={items:{},add:function(t,e){return this.set(t,e),e},set:function(t,e){this.items[t]=e},get:function(t){return this.items[t]},remove:function(t){this.items[t]=null}},jmUtils.browser=function(){if(jmUtils.browserInfo)return jmUtils.browserInfo;if(jmUtils.browserInfo={agent:navigator.userAgent},/Mobile/i.test(jmUtils.browserInfo.agent)&&(jmUtils.browserInfo.mobile=!0),/iPad/i.test(jmUtils.browserInfo.agent)?jmUtils.browserInfo.iPad=!0:/iPhone/i.test(jmUtils.browserInfo.agent)?jmUtils.browserInfo.iPhone=!0:/Android/i.test(jmUtils.browserInfo.agent)&&(jmUtils.browserInfo.android=!0),/msie/i.test(jmUtils.browserInfo.agent)){jmUtils.browserInfo.msie=!0;var t=jmUtils.browserInfo.agent.match(/msie\s+\d+(\.\d+)*/i)[0];jmUtils.browserInfo.ver=t.match(/\d+(\.\d+)*/)[0]}else/Chrome/i.test(jmUtils.browserInfo.agent)?jmUtils.browserInfo.chrome=!0:/Safari/i.test(jmUtils.browserInfo.agent)?jmUtils.browserInfo.safari=!0:/Firefox/i.test(jmUtils.browserInfo.agent)&&(jmUtils.browserInfo.firefox=!0);return jmUtils.browserInfo},jmUtils.isSupportedBrowser=function(){var t=jmUtils.browser();return!t.msie||8<t.ver},jmUtils.checkSupportedMode=function(){var t=document.createElement("canvas");if(t&&t.getContext)return"canvas";if(document.createElementNS)return"svg";if(this.browser().msie&&this.browser().ver<9)return"vml";throw"not supported browser"},jmUtils.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},jmUtils.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},jmUtils.loadImg=function(t,e){if(jmUtils.isArray(t)||"object"==typeof t){var i=0,s=0;for(var n in t)i++,e?jmUtils.loadImg(t[n],function(){++s==i&&e()}):jmUtils.loadImg(t[n])}else if("string"==typeof t){var o=document.createElement("img");e&&(o.onload=function(){e()},o.onerror=function(){e()}),o.src=t}else e()},jmUtils.require=function(e,i){if(jmUtils.isArray(e)){var s=e.length;for(var t in e)jmUtils.require(e[t],function(t,e){e?i&&i(t,e):0==--s&&i&&i(s)})}else{var n=document.getElementsByTagName("script");for(var t in n)if(n[t].src===e)return void(i&&i(e));(n=document.createElement("script")).type="text/javascript",n.charset="utf-8",n.src=e;var o=document.getElementsByTagName("head")[0];if(o.appendChild(n),i){function r(t){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||i&&i(e)}n.readyState?n.onreadystatechange=r:n.onload=r}n.onerror=function(){o.removeChild(n),i&&i(e,"load faild")}}},jmUtils.bindEvent=function(t,e,i,s){if(!e||-1==e.indexOf(" "))return t.attachEvent?t.attachEvent("on"+e,i,s):!!t.addEventListener&&(t.addEventListener(e,i,s),!0);for(var n=e.split(" "),o=0;o<n.length;o++)jmUtils.bindEvent(t,n[o],i,s)},jmUtils.removeEvent=function(t,e,i){return t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?(t.detachEvent("on"+e,i),!0):void(t["on"+e]=null)},jmUtils.getElementPosition=function(t){var e={top:0,left:0};if(!t)return e;if(t.offsetParent)for(;t.offsetParent;)e.top+=t.offsetTop,e.left+=t.offsetLeft,t=t.offsetParent;else t.x?e.left+=t.x:t.x&&(e.top+=t.y);return e},jmUtils.getEventPosition=function(t,e){var i=!1,s=(t=t||event).changedTouches||t.targetTouches||t.touches,n=t.target||t.srcElement;s&&((t=s[0]).target=n,i=!0);var o=t.pageX||t.x||t.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),r=t.pageY||t.y||t.clientY+(document.documentElement.scrollTop||document.body.scrollTop),h=t.offsetX,a=t.offsetY;if(void 0===h&&void 0===a){var l=jmUtils.getElementPosition(n);h=o-l.left,a=r-l.top}return e&&(e.x&&(h/=e.x),e.y&&(a/=e.y)),{pageX:o,pageY:r,clientX:t.clientX,clientY:t.clientY,offsetX:h,offsetY:a,layerX:t.layerX,layerY:t.layerY,screenX:t.screenX,screenY:t.screenY,x:h,y:a,isTouch:i}},jmUtils.isType=function(t,e){return!(!t||"object"!=typeof t)&&t.constructor===e},jmUtils.pointInPolygon=function(t,e,i){i=i||1,i/=2;var s,n,o=e.length,r=!1,h=!0;if(!e||0==o)return 0;if(1==o)return Math.abs(e[0].x-t.x)<=i&&Math.abs(e[0].y-t.y)<=i;if(2==o){if(Math.min(e[0].x,e[1].x)-t.x>i||t.x-Math.max(e[0].x,e[1].x)>i)return 0;if(Math.min(e[0].y,e[1].y)-t.y>i||t.y-Math.max(e[0].y,e[1].y)>i)return 0;if(e[0].x==e[1].x)return Math.abs(e[0].x-t.x)<=i&&(t.y-e[0].y)*(t.y-e[1].y)<=0?1:0;if(e[0].y==e[1].y)return Math.abs(e[0].y-t.y)<=i&&(t.x-e[0].x)*(t.x-e[1].x)<=0?1:0;if(Math.abs(e[0].x-t.x)<i&&Math.abs(e[0].y-t.y)<i)return 1;if(Math.abs(e[1].x-t.x)<i&&Math.abs(e[1].y-t.y)<i)return 1;if(t.y!=e[0].y&&t.y!=e[1].y){var a=(e[1].x-e[0].x)/(e[1].y-e[0].y)*(t.y-e[0].y),l=(t.y-e[0].y)/Math.sqrt(a*a+(t.y-e[0].y)*(t.y-e[0].y))*(t.x-e[0].x-a);return Math.abs(l)<=i?1:0}return 0}for(s=0;s<o;++s)if(e[s].x==t.x&&e[s].y==t.y)return 1;for(t=jmUtils.clone(t);h;)for(r=h=!1,s=0,n=o-1;s<o;n=s++)if(e[s].y<t.y&&t.y<e[n].y||e[n].y<t.y&&t.y<e[s].y){if(t.x<=e[s].x||t.x<=e[n].x){var p=(t.y-e[s].y)*(e[n].x-e[s].x)/(e[n].y-e[s].y)+e[s].x;if(t.x<p)r=!r;else if(t.x==p)return 1}}else if(t.y==e[s].y){if(t.x<e[s].x){e[s].y>e[n].y?--t.y:++t.y,h=!0;break}}else if(e[s].y==e[n].y&&t.y==e[s].y&&(e[s].x<t.x&&t.x<e[n].x||e[n].x<t.x&&t.x<e[s].x)){r=!0;break}return r?2:0},jmUtils.checkOutSide=function(t,e,i){var s={left:0,right:0,top:0,bottom:0};return i.x<0?s.left=e.left+i.x-t.left:0<i.x&&(s.right=e.right+i.x-t.right),i.y<0?s.top=e.top+i.y-t.top:0<i.y&&(s.bottom=e.bottom+i.y-t.bottom),s},jmUtils.rotatePoints=function(t,e,i){if(!i||!t)return t;var s=Math.cos(i),n=Math.sin(i);if(t.length){for(var o=0;o<t.length;o++)if(t[o]){var r=t[o].x-e.x,h=t[o].y-e.y;t[o].x=r*s-h*n+e.x,t[o].y=r*n+h*s+e.y}}else{r=t.x-e.x,h=t.y-e.y;t.x=r*s-h*n+e.x,t.y=r*n+h*s+e.y}return t},jmUtils.offsetPoints=function(t,e){if(!e)return t;if(t.length)for(var i=0;i<t.length;i++)t[i].x+=e.x,t[i].y+=e.y;else t.x+=e.x,t.y+=e.y;return t},jmUtils.getDistance=function(t,e){var i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)},jmUtils.guid=function(){return(new Date).getTime()},jmUtils.trimStart=function(t,e){if(e=e||" ",t&&0<t.length){var i=t[0];if(i===e||0<=e.indexOf(i))return t=t.substring(1),jmUtils.trimStart(t,e)}return t},jmUtils.trimEnd=function(t,e){if(e=e||" ",t&&0<t.length){var i=t[t.length-1];if(i===e||0<=e.indexOf(i))return t=t.substring(0,t.length-1),jmUtils.trimStart(t,e)}return t},jmUtils.trim=function(t,e){return jmUtils.trimEnd(jmUtils.trimStart(t,e),e)},jmUtils.checkPercent=function(t){if("string"==typeof t&&"%"==(t=jmUtils.trim(t))[t.length-1])return t},jmUtils.percentToNumber=function(t){if("string"==typeof t){var e=jmUtils.checkPercent(t);e&&(t=jmUtils.trim(e,"% "),t/=100)}return t},jmUtils.indexOf=function(t,e){if(jmUtils.isArray(e)){for(var i=0;i<e.length;i++)if(e[i]==t)return i}else if("string"==typeof e)return e.indexOf(t);return-1},jmUtils.parseXML=function(t){var e;if(DOMParser){e=(new DOMParser).parseFromString(t,"text/xml")}else{if(!window.ActiveXObject)return null;(e=new ActiveXObject("Microsoft.XMLDOM")).async=!1,e.loadXML(t)}return e},jmUtils.xmlToJSON=function(t){if(!t)return null;"string"==typeof t&&(t=jmUtils.parseXML(t));var e={children:[]};return e.version=t.xmlVersion,e.title=t.title,function t(e,i){if(e&&e.childNodes&&0<e.childNodes.length)for(var s=0;s<e.childNodes.length;s++){var n=e.childNodes[s];if(1==n.nodeType){var o=n.name||n.nodeName||n.tagName;if(o){var r={children:[],attributes:{}};if(n.attributes)for(var h in n.attributes){var a=n.attributes[h],l=a.name||a.nodeName;l&&(r.attributes[l]=jmUtils.trim(a.value||n.nodeValue||a.textContent))}r.name=o,r.value=jmUtils.trim(n.value||n.nodeValue||n.textContent),i.children.push(r),t(n,r)}else i.value=jmUtils.trim(n.value||n.nodeValue||n.textContent),t(n,i)}}}(t,e),e},jmUtils.hexToNumber=function(t){if("string"!=typeof t)return t;for(var e=0,i=(t=t.toLowerCase()).length,s=0;s<i;s++){var n="0123456789abcdef".indexOf(t[s]);if(0!=n){for(var o=1;o<i-s;o++)n*=16;e+=n}}return e},jmUtils.numberToHex=function(t){for(var e="";0<t;){e="0123456789abcdef"[t%16]+e,t=Math.floor(t/16)}return e},jmUtils.toColor=function(t,e,i,s){return"string"==typeof t&&t&&"#"==(t=this.trim(t))[0]&&(8<=t.length?(s=t.substr(1,2),e=t.substr(5,2),i=t.substr(7,2),t=t.substr(3,2),s=(this.hexToNumber(s)/255).toFixed(4),t=this.hexToNumber(t||0),e=this.hexToNumber(e||0),i=this.hexToNumber(i||0)):5===t.length&&(s=t.substr(1,1),e=t.substr(3,1),i=t.substr(4,1),t=t.substr(2,1),t=this.hexToNumber(t||0),e=this.hexToNumber(e||0),i=this.hexToNumber(i||0),s=(this.hexToNumber(s)/255).toFixed(4))),void 0!==t&&void 0!==e&&void 0!==i?void 0!==s?"rgba("+t+","+e+","+i+","+s+")":"rgb("+t+","+e+","+i+")":t},jmUtils.parseDate=function(t){if(jmUtils.isDate(t))return t;if("number"==typeof t)return new Date(t);var e=(t+",0,0,0").match(/\d+/g);return e[5]?new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5]):new Date(t)},jmUtils.formatDate=function(t,e){return t=this.parseDate(t||new Date),(e=e||"yyyy-MM-dd HH:mm:ss").replace("yyyy",t.getFullYear().toString()).replace("MM",(t.getMonth()<9?"0":"")+(t.getMonth()+1).toString()).replace("dd",(t.getDate()<9?"0":"")+t.getDate().toString()).replace("HH",(t.getHours()<9?"0":"")+t.getHours().toString()).replace("mm",(t.getMinutes()<9?"0":"")+t.getMinutes().toString()).replace("ss",(t.getSeconds()<9?"0":"")+t.getSeconds().toString())},jmUtils.createProperty=function(t,e,i){var s={configurable:!1,enumerable:!0,name:e,defaultValue:i};return i&&(i instanceof jmUtils.list||"function"!=typeof i.set&&"function"!=typeof i.get?"object"==typeof i&&("value"in i||"configurable"in i||"enumerable"in i||"writable"in i)&&(s.value=i.value,s.configurable="boolean"!=typeof i.configurable||i.configurable,s.enumerable="boolean"!=typeof i.enumerable||i.enumerable,s.writable="boolean"!=typeof i.writable||i.writable):(s.set=i.set,s.get=i.get)),"get"in s||"set"in s||"value"in s||"writable"in s||(s.get=function(){return!this.canvas||"width"!=s.name&&"height"!=s.name?(this.__properties=this.__properties||{},this.__properties[s.name]):this.canvas[s.name]},s.set=function(t){if(!this.canvas||"width"!=s.name&&"height"!=s.name){this.__properties=this.__properties||{};this.__properties[s.name];this.__properties[s.name]=t}else this.canvas[s.name]=t;this.needUpdate=!0}),Object.defineProperty(t,e,s)},jmUtils.createProperty(jmObject.prototype,"id",{get:function(){return this.__properties=this.__properties||{},this.__properties.id||(this.__properties.id=Date.now().toString()+Math.floor(1e3*Math.random())),this.__properties.id}}),jmUtils.createProperty(jmObject.prototype,"needUpdate",{get:function(){return this.__properties=this.__properties||{},this.__properties.needUpdate},set:function(t){this.__properties=this.__properties||{},(this.__properties.needUpdate=t)&&!this.is("jmGraph")&&this.graph&&(this.graph.needUpdate=!0)}}),jmObject.prototype.is=function(t){return"string"==typeof t?this.type==t:this instanceof t},jmObject.prototype.animate=function(t,e){if(this.is("jmGraph")){if(t){this.animateHandles||(this.animateHandles=new jmUtils.list);var i=[];if(2<arguments.length)for(var s=2;s<arguments.length;s++)i.push(arguments[s]);this.animateHandles.add({millisec:e||20,handle:t,params:i})}if(this.animateHandles&&0<this.animateHandles.count()){var o=this;this.dispatcher=setTimeout(function(i){i=i||o;var s=[],n=(new Date).getTime();for(var t in i.animateHandles.each(function(t,e){try{if(e&&e.handle&&(!e.times||n-e.times>=e.millisec))!1===e.handle.apply(i,e.params)&&s.push(e),e.times=n}catch(t){window.console&&window.console.info&&window.console.info(t.toString()),e&&s.push(e)}}),s)i.animateHandles.remove(s[t]);i.animate()},10,this)}}else{var n=this.findParent("jmGraph");n&&n.animate.apply(n,arguments)}};var jmProperty=function(){this.__properties={},this.__eventHandles={}};function jmControl(t,e){}function runEventHandle(t,i){var e=this.getEvent(t);if(e){var s=this;e.each(function(t,e){!1===e.call(s,i)&&(i.cancel=!0)})}return i.cancel}function jmShape(t){this.type="jmShape",this.graph=t,this.initializing(t.context,style)}function jmPath(t,e){this.type="jmPath";var i=e&&e.style?e.style:null;this.graph=t,this.points=e&&e.points?e.points:[],this.initializing(t.context,i)}function jmArc(t,e){e||(e={}),this.points=e.points||[];var i=e.style||{};this.type="jmArc",this.graph=t,this.center=e.center||{x:0,y:0},this.radius=e.radius||0,this.startAngle=e.start||e.startAngle||0,this.endAngle=e.end||e.endAngle||2*Math.PI,this.width=e.width||0,this.height=e.height||0,this.anticlockwise=e.anticlockwise||0,this.initializing(t.context,i)}function jmArraw(t,e){e||(e={}),this.points=e.points||[];var i=e.style||{};this.type="jmArraw",i.lineJoin="miter",i.lineCap="square",this.graph=t,this.angle=e.angle||0,this.start=e.start||{x:0,y:0},this.end=e.end||{x:0,y:0},this.offsetX=e.offsetX||5,this.offsetY=e.offsetY||8,this.initializing(t.context,i)}function jmBezier(t,e){e||(e={}),this.type="jmBezier",this.cpoints=e.points||[],this.points=[];var i=e.style||{};this.graph=t,this.initializing(t.context,i)}function jmCircle(t,e){e||(e={}),this.type="jmCircle",this.points=e.points||[];var i=e.style||{};this.graph=t,this.center=e.center||{x:0,y:0},this.radius=e.radius||0,this.startAngle=e.start||e.startAngle||0,this.endAngle=e.end||e.endAngle||2*Math.PI,this.width=e.width||0,this.height=e.height||0,this.anticlockwise=e.anticlockwise||0,this.initializing(t.context,i)}function jmHArc(t,e){e||(e={}),this.type="jmHArc",this.points=e.points||[];var i=e.style||{};this.graph=t,this.center=e.center||{x:0,y:0},this.minRadius=e.minRadius||i.minRadius||0,this.maxRadius=e.maxRadius||i.maxRadius||0,this.startAngle=e.start||e.startAngle||0,this.endAngle=e.end||e.endAngle||2*Math.PI,this.width=e.width||0,this.height=e.height||0,this.anticlockwise=e.anticlockwise||0,this.initializing(t.context,i)}function jmLine(t,e){e||(e={}),this.type="jmLine",this.points=e.points||[];var i=e.style||{};this.graph=t,this.start=e.start||{x:0,y:0},this.end=e.end||{x:0,y:0},i.lineType=i.lineType||"solid",i.dashLength=i.dashLength||4,this.initializing(t.context,i)}function jmPrismatic(t,e){e||(e={}),this.type="jmPrismatic",this.points=e.points||[];var i=e.style||{};i.close=void 0===i.close||i.close,this.graph=t,this.center=e.center||{x:0,y:0},this.width=e.width||0,this.height=e.height||0,this.initializing(t.context,i)}function jmRect(t,e){e||(e={}),this.type="jmRect",this.createProperty("points",e.points||[]);var i=e.style||{};i.close=!0,this.createProperty("graph",t),this.position=e.position||{x:0,y:0},this.width=e.width||0,this.height=e.height||0,this.radius=e.radius||i.radius||0,this.graph=t,this.initializing(t.context,i)}function jmArrawLine(t,e){e||(e={}),this.points=e.points||[];var i=e.style||{};i.lineJoin=i.lineJoin||"miter",this.graph=t,this.type="jmArrawLine",this.start=e.start||(e.start={x:0,y:0}),this.end=e.end||(e.end={x:0,y:0}),this.initializing(t.context,i),this.line=t.createShape("line",e),this.arraw=t.createShape("arraw",e)}function jmImage(t,e){var i=e&&e.style?e.style:{};i.fill=i.fill||"transparent",this.graph=t,this.width=e.width,this.height=e.height,this.type="jmImage",this.position=e.position||{x:0,y:0},this.sourceWidth=e.sourceWidth,this.sourceHeight=e.sourceHeight,this.sourcePosition=e.sourcePosition,this.image=e.image||i.image,this.initializing(t.context,i)}function jmLabel(t,e){e||(e={});var i=e.style||{};i.font=i.font||"15px Arial",i.fontFamily=i.fontFamily||"Arial",i.fontSize=i.fontSize||15,this.type="jmLabel",i.textAlign=i.textAlign||"left",i.textBaseline=i.textBaseline||"middle",this.graph=t,this.text=e.text||"",this.position=e.position||{x:0,y:0},this.width=e.width||0,this.height=e.height||0,this.initializing(t.context,i)}function jmResize(t,e){this.params=e||{};var i=e.style||{};this.type="jmResize",this.enabled=!1!==e.enabled,this.graph=t,this.position=e.position||{x:0,y:0},this.width=e.width||0,this.height=e.height||0,this.points=e.points||[],this.rectSize=e.rectSize||8,i.close=i.close||!0,this.initializing(t.context,i),this.init()}jmUtils.extend(jmProperty,jmObject),jmProperty.prototype.getValue=function(t){return this.__properties||(this.__properties={}),this.__properties[t]},jmProperty.prototype.setValue=function(t,e){if(void 0!==e){this.__properties||(this.__properties={});var i={oldValue:this.getValue(t),newValue:e};this.__properties[t]=e,this.emit("PropertyChange",t,i)}return this.getValue(t)},jmProperty.prototype.createProperty=function(t,e){return jmUtils.createProperty(this,t,e)},jmProperty.prototype.on=function(t,e){this.__eventHandles||(this.__eventHandles={});var i=this.__eventHandles[t];for(var s in i||(i=this.__eventHandles[t]=[]),i)if(i[s]===e)return;return i.push(e),this},jmProperty.prototype.emit=function(t){var e=this.__eventHandles?this.__eventHandles[t]:null;if(e){var i=[],s=arguments.length;if(1<s)for(var n=1;n<s;n++)i.push(arguments[n]);for(var n in e)e[n].apply(this,i)}return this},jmUtils.extend(jmControl,jmProperty),jmUtils.createProperty(jmControl.prototype,"style",{}),jmUtils.createProperty(jmControl.prototype,"visible",!0),jmUtils.createProperty(jmControl.prototype,"children",new jmUtils.list),jmUtils.createProperty(jmControl.prototype,"position"),jmUtils.createProperty(jmControl.prototype,"width",0),jmUtils.createProperty(jmControl.prototype,"height",0),jmUtils.createProperty(jmControl.prototype,"zIndex",{get:function(){return this.__properties=this.__properties||{},this.__properties.zIndex},set:function(t){this.__properties.zIndex=t,this.children.sort(),t&&!this.is("jmGraph")&&this.graph&&(this.graph.needUpdate=!0)}}),jmControl.prototype.initializing=function(t,e){this.context=t,this.style=e||{};var i=this;this.children=new jmUtils.list;var n=this.children.add;this.children.add=function(t){if("object"==typeof t)return t.parent&&t.parent!=i&&t.parent.children&&t.parent.children.remove(t),t.parent=i,this.contain(t)&&this.oremove(t),n.call(this,t),t.emit("add",t),i.needUpdate=!0,i.graph&&(t.graph=i.graph),this.sort(),t},this.children.oremove=this.children.remove,this.children.remove=function(t){"object"==typeof t&&(t.parent=null,t.graph=null,t.remove(!0),this.oremove(t),i.needUpdate=!0)},this.children.sort=function(){var s={};for(var t in this.each(function(t,e){var i=e.zIndex;(!i&&e.style&&e.style.zIndex&&(i=Number(e.style.zIndex),isNaN(i)&&(i=e.style.zIndex||0)),i)&&(s[i]||(s[i]=[])).push(e)}),s)n.call(this,s[t]);i.needUpdate=!0},this.children.clear=function(){this.each(function(t,e){this.remove(e)},!0)},this.needUpdate=!0},jmControl.prototype.cursor=function(t){var e=this.graph||this.findParent("jmGraph");e&&e.css("cursor",t)},jmControl.prototype.setStyle=function(t){if(t=t||this.style)for(var e in this.translate&&m(this,{translate:this.translate},"translate"),this.transform&&m(this,{transform:this.transform},"transform"),t){var i=typeof t[e];"string"==i&&-1<t[e].indexOf("-gradient")?t[e]=new jmGradient(t[e]):"string"==i&&"shadow"==e&&(t[e]=new jmShadow(t[e])),m(this,t[e],e)}function m(t,e,i,s){if(e){var n="jm_control_style_mapping",o=jmUtils.cache.get(n);o||(o={fill:"fillStyle",stroke:"strokeStyle","shadow.blur":"shadowBlur","shadow.x":"shadowOffsetX","shadow.y":"shadowOffsetY","shadow.color":"shadowColor",lineWidth:"lineWidth",miterLimit:"miterLimit",fillStyle:"fillStyle",strokeStyle:"strokeStyle",font:"font",opacity:"globalAlpha",textAlign:"textAlign",textBaseline:"textBaseline",shadowBlur:"shadowBlur",shadowOffsetX:"shadowOffsetX",shadowOffsetY:"shadowOffsetY",shadowColor:"shadowColor",lineJoin:"lineJoin",lineCap:"lineCap"},jmUtils.cache.add(n,o));var r=typeof e,h=o[s||i];if(jmUtils.isType(e,jmGradient)||"string"==r&&-1<e.indexOf("-gradient"))"string"==r&&-1<e.indexOf("-gradient")&&(e=new jmGradient(e)),m(t,e.toGradient(t),h||i);else if("function"==r)h&&(e=e.call(this,h))&&m(t,e,h);else if(h)"string"==r&&-1<["fillStyle","strokeStyle","shadowColor"].indexOf(h)&&(e=jmUtils.toColor(e)),t.context[h]=e;else switch(i){case"shadow":if("string"==r){m(t,new jmShadow(e),i);break}for(var a in e)m(t,e[a],a,i+"."+a);break;case"translate":t.context.translate(e.x,e.y);break;case"rotation":var l=0,p=0;if(e.point){var c=t.absoluteBounds?t.absoluteBounds:t.getAbsoluteBounds();l=(e=t.getRotation(e)).rotateX+c.left,p=e.rotateY+c.top}0==l&&0==p||t.context.translate(l,p),t.context.rotate(e.angle),0==l&&0==p||t.context.translate(-l,-p);break;case"transform":jmUtils.isArray(e)?t.context.transform.apply(t.context,e):"object"==typeof e&&t.context.transform(e.scaleX,e.skewX,e.skewY,e.scaleY,e.offsetX,e.offsetY);break;case"translate":t.context.translate(e.x,e.y);break;case"cursor":t.cursor(e)}}}},jmControl.prototype.getBounds=function(t){if(this.bounds&&!t)return this.bounds;var e={left:void 0,top:void 0};if("jmGraph"==this.type&&this.canvas)"function"==typeof this.canvas.width?e.right=this.canvas.width():this.canvas.width?e.right=this.canvas.width:this.width&&(e.right=this.width),"function"==typeof this.canvas.height?e.bottom=this.canvas.height():this.canvas.height?e.bottom=this.canvas.height:this.height&&(e.bottom=this.height);else if(this.points&&0<this.points.length)for(var i in this.points){var s=this.points[i];(void 0===e.left||e.left>s.x)&&(e.left=s.x),(void 0===e.top||e.top>s.y)&&(e.top=s.y),(void 0===e.right||e.right<s.x)&&(e.right=s.x),(void 0===e.bottom||e.bottom<s.y)&&(e.bottom=s.y)}else if(this.getLocation){(s=this.getLocation())&&(e.left=s.left,e.top=s.top,e.right=s.left+s.width,e.bottom=s.top+s.height)}return e.left||(e.left=0),e.top||(e.top=0),e.right||(e.right=0),e.bottom||(e.bottom=0),e.width=e.right-e.left,e.height=e.bottom-e.top,this.bounds=e},jmControl.prototype.getLocation=function(t){var e=this.location={left:0,top:0,width:0,height:0};e.position="function"==typeof this.position?this.position():this.position,e.center=this.center&&"function"==typeof this.center?this.center():this.center,e.start=this.start&&"function"==typeof this.start?this.start():this.start,e.end=this.end&&"function"==typeof this.end?this.end():this.end,e.radius=this.radius,e.width=this.width,e.height=this.height;var i=this.style.margin||{};if(i.left=i.left||0,i.top=i.top||0,i.right=i.right||0,i.bottom=i.bottom||0,e.position?(e.left=e.position.x,e.top=e.position.y):(e.left=i.left,e.top=i.top),!this.parent)return e;var s=this.parent.getBounds();return jmUtils.checkPercent(e.left)&&(e.left=jmUtils.percentToNumber(e.left)*s.width),jmUtils.checkPercent(e.top)&&(e.top=jmUtils.percentToNumber(e.top)*s.height),jmUtils.checkPercent(e.width)&&(e.width=jmUtils.percentToNumber(e.width)*s.width),jmUtils.checkPercent(e.height)&&(e.height=jmUtils.percentToNumber(e.height)*s.height),e.center&&(jmUtils.checkPercent(e.center.x)&&(e.center.x=jmUtils.percentToNumber(e.center.x)*s.width),jmUtils.checkPercent(e.center.y)&&(e.center.y=jmUtils.percentToNumber(e.center.y)*s.height)),e.radius&&jmUtils.checkPercent(e.radius)&&(e.radius=jmUtils.percentToNumber(e.radius)*Math.min(s.width,s.height)),e},jmControl.prototype.getRotation=function(t){if(t=t||this.style.rotation){e=this.getBounds();t.rotateX=t.point.x,jmUtils.checkPercent(t.rotateX)&&(t.rotateX=jmUtils.percentToNumber(t.rotateX)*e.width),t.rotateY=t.point.y,jmUtils.checkPercent(t.rotateY)&&(t.rotateY=jmUtils.percentToNumber(t.rotateY)*e.height)}else if(t=this.parent&&this.parent.getRotation?this.parent.getRotation():null){var e=this.getBounds();t.rotateX-=e.left,t.rotateY-=e.top}return t},jmControl.prototype.remove=function(){this.parent&&this.parent.children.remove(this)},jmControl.prototype.offset=function(t,e,i,s){i=!1!==i;var n=this.getLocation(!0),o=!1;if(n.position&&(n.left+=t,n.top+=e,n.position.x=n.left,n.position.y=n.top,o=!0),0==o&&n.center&&(n.center.x=n.center.x+t,n.center.y=n.center.y+e,o=!0),n.start&&"object"==typeof n.start&&(n.start.x=n.start.x+t,n.start.y=n.start.y+e,o=!0),n.end&&"object"==typeof n.end&&(n.end.x=n.end.x+t,n.end.y=n.end.y+e,o=!0),0==o&&this.cpoints){var r=(this.cpoints,this.cpoints);if(r){for(var h=r.length,a=0;a<h;a++)r[a].x+=t,r[a].y+=e;o=!0}}if(0==o&&this.points){for(h=this.points.length,a=0;a<h;a++)this.points[a].x+=t,this.points[a].y+=e;o=!0}this.emit("move",{offsetX:t,offsetY:e,trans:i,evt:s}),this.needUpdate=!0},jmControl.prototype.rotate=function(t,e){this.style.rotation={angle:t,point:e},this.needUpdate=!0},jmControl.prototype.getAbsoluteBounds=function(){var t=this.getBounds();if(this.parent&&this.parent.absoluteBounds){var e=this.parent.absoluteBounds||this.parent.getAbsoluteBounds();return{left:e.left+t.left,top:e.top+t.top,right:e.left+t.right,bottom:e.top+t.bottom,width:t.width,height:t.height}}return t},jmControl.prototype.beginDraw=function(){this.getLocation(!0),this.context.beginPath()},jmControl.prototype.endDraw=function(){this.style.close&&this.context.closePath(),this.style.fill&&this.context.fill(),!this.style.stroke&&this.style.fill||this.context.stroke(),this.needUpdate=!1},jmControl.prototype.draw=function(){if(this.points&&0<this.points.length){var t=this.parent&&this.parent.absoluteBounds?this.parent.absoluteBounds:this.absoluteBounds;this.context.moveTo(this.points[0].x+t.left,this.points[0].y+t.top);for(var e=this.points.length,i=1;i<e;i++){var s=this.points[i];s.m?this.context.moveTo(s.x+t.left,s.y+t.top):this.context.lineTo(s.x+t.left,s.y+t.top)}}},jmControl.prototype.paint=function(t){if(!1!==t&&!1!==this.visible){this.initPoints&&this.initPoints(),this.bounds=null,this.absoluteBounds=this.getAbsoluteBounds();var e=!0;!this.is("jmGraph")&&this.graph&&(this.absoluteBounds.left>=this.graph.width?e=!1:this.absoluteBounds.top>=this.graph.height?e=!1:this.absoluteBounds.right<=0?e=!1:this.absoluteBounds.bottom<=0&&(e=!1)),this.context.save(),this.setStyle(),this.emit("beginDraw",this),e&&this.beginDraw&&this.beginDraw(),e&&this.draw&&this.draw(),e&&this.endDraw&&this.endDraw(),this.children&&this.children.each(function(t,e){e&&e.paint&&e.paint()}),this.emit("endDraw",this),this.context.restore(),"jmGraph"==this.type&&this.context.draw&&this.context.draw(),this.needUpdate=!1}},jmControl.prototype.getEvent=function(t){return this.__events?this.__events[t]:null},jmControl.prototype.bind=jmControl.prototype.on=function(t,e){var i=this.getEvent(t)||function(t,e){return this.__events||(this.__events={}),this.__events[t]=e}.call(this,t,new jmUtils.list);i.contain(e)||i.add(e)},jmControl.prototype.unbind=function(t,e){var i=this.getEvent(t);i&&(e?i.remove(e):i.clear())},jmControl.prototype.checkPoint=function(t,e){if("jmGraph"==this.type){var i=this.getPosition();return!(t.pageX>i.right||t.pageX<i.left)&&!(t.pageY>i.bottom||t.pageY<i.top)}var s=this.getBounds(),n=this.getRotation(),o=this.points;if(o&&o.length||((o=[]).push({x:s.left,y:s.top}),o.push({x:s.right,y:s.top}),o.push({x:s.right,y:s.bottom}),o.push({x:s.left,y:s.bottom}),o.push({x:s.left,y:s.top})),e=Number(e||this.style.touchPadding||this.style.lineWidth||1),o&&o.length){if(n&&0!=n.angle&&(o=jmUtils.clone(o,!0),o=jmUtils.rotatePoints(o,{x:n.rotateX+s.left,y:n.rotateY+s.top},n.angle)),2<o.length&&(!this.style.fill||this.style.stroke)){for(var r=0,h=o.length,a=r+1;a<=h;a=++r+1){if(a==h){if(this.style.close)if(jmUtils.pointInPolygon(t,[o[r],o[0]],e))return!0}else if(jmUtils.pointInPolygon(t,[o[r],o[a]],e))return!0}if(!this.style.fill)return!1}return jmUtils.pointInPolygon(t,o,e)}return!(t.x>s.right||t.x<s.left)&&!(t.y>s.bottom||t.y<s.top)},jmControl.prototype.raiseEvent=function(i,s){if(!1!==this.visible){if(!s.position){var t=this.graph||this.findParent("jmGraph"),e=jmUtils.getEventPosition(s,t.scaleSize),n=s.srcElement||s.target;s={position:e,button:0==s.button||e.isTouch?1:s.button,keyCode:s.keyCode||s.charCode||s.which,ctrlKey:s.ctrlKey,cancel:!1,srcElement:n}}s.path=s.path||[],this.children&&this.children.each(function(t,e){!0!==s.cancel&&e.raiseEvent(i,s)},!0);var o=this.parent&&this.parent.absoluteBounds?this.parent.absoluteBounds:this.absoluteBounds;return!!o&&(s.position.x=s.position.offsetX-o.left,s.position.y=s.position.offsetY-o.top,this.checkPoint(s.position)?(s.target||(s.target=this),s.path.push(this),!0!==s.cancel&&runEventHandle.call(this,i,s),this.focused||"mousemove"!=i||(this.focused=!0,this.raiseEvent("mouseover",s))):this.focused&&"mousemove"==i&&(this.focused=!1,runEventHandle.call(this,"mouseleave",s)),0==s.cancel)}},jmControl.prototype.clearEvents=function(t){var e=this.getEvent(t);e&&e.clear},jmControl.prototype.findParent=function(t){if("string"==typeof t){if(this.type==t)return this}else if(this.is(t))return this;return this.parent?this.parent.findParent(t):null},jmControl.prototype.canMove=function(t,e){if(!this.__mvMonitor){this.__mvMonitor={},this.__mvMonitor.mouseDown=!1,this.__mvMonitor.curposition={x:0,y:0};var h=this;this.__mvMonitor.mv=function(t){var e=h;if(e.__mvMonitor.mouseDown){e.parent.bounds=null;var i=e.parent.getAbsoluteBounds(),s=t.position.offsetX-e.__mvMonitor.curposition.x,n=t.position.offsetY-e.__mvMonitor.curposition.y;if(e.lockSide){var o=e.bounds||e.getAbsoluteBounds(),r=jmUtils.checkOutSide(i,o,{x:s,y:n});r.left<0?e.lockSide.left&&(s-=r.left):0<r.right&&e.lockSide.right&&(s-=r.right),r.top<0?e.lockSide.top&&(n-=r.top):0<r.bottom&&e.lockSide.bottom&&(n-=r.bottom)}return(s||n)&&(e.offset(s,n,!0,t),e.__mvMonitor.curposition.x=t.position.offsetX,e.__mvMonitor.curposition.y=t.position.offsetY),!1}},this.__mvMonitor.mu=function(t){var e=h;e.__mvMonitor.mouseDown&&(e.__mvMonitor.mouseDown=!1,e.emit("moveend",{position:e.__mvMonitor.curposition}))},this.__mvMonitor.ml=function(){var t=h;if(t.__mvMonitor.mouseDown)return t.__mvMonitor.mouseDown=!1,t.emit("moveend",{position:t.__mvMonitor.curposition}),!1},this.__mvMonitor.md=function(t){if(!this.__mvMonitor.mouseDown&&(0==t.button||1==t.button)){this.__mvMonitor.mouseDown=!0;var e=this.parent.absoluteBounds||this.parent.getAbsoluteBounds();return this.__mvMonitor.curposition.x=t.position.x+e.left,this.__mvMonitor.curposition.y=t.position.y+e.top,this.emit("movestart",{position:this.__mvMonitor.curposition}),!(t.cancel=!0)}}}return e=e||this.graph||this.findParent("jmGraph"),!1!==t?(e.bind("mousemove",this.__mvMonitor.mv),e.bind("mouseup",this.__mvMonitor.mu),e.bind("mouseleave",this.__mvMonitor.ml),this.bind("mousedown",this.__mvMonitor.md),e.bind("touchmove",this.__mvMonitor.mv),e.bind("touchend",this.__mvMonitor.mu),this.bind("touchstart",this.__mvMonitor.md)):(e.unbind("mousemove",this.__mvMonitor.mv),e.unbind("mouseup",this.__mvMonitor.mu),e.unbind("mouseleave",this.__mvMonitor.ml),this.unbind("mousedown",this.__mvMonitor.md),e.unbind("touchmove",this.__mvMonitor.mv),e.unbind("touchend",this.__mvMonitor.mu),this.unbind("touchstart",this.__mvMonitor.md)),this},jmUtils.extend(jmShape,jmControl),jmUtils.extend(jmPath,jmShape),jmUtils.createProperty(jmPath.prototype,"points"),void 0!==jmGraph&&(jmGraph.prototype.shapes.path=jmPath),jmUtils.extend(jmArc,jmPath),jmUtils.createProperty(jmArc.prototype,"center"),jmUtils.createProperty(jmArc.prototype,"radius",0),jmUtils.createProperty(jmArc.prototype,"startAngle",0),jmUtils.createProperty(jmArc.prototype,"endAngle",2*Math.PI),jmUtils.createProperty(jmArc.prototype,"anticlockwise",!1),jmArc.prototype.initPoints=function(){var t=this.getLocation(),e=0,i=0,s=t.center.x,n=t.center.y;t.radius?e=i=t.radius:(e=t.width/2,i=t.height/2);var o=this.startAngle,r=this.endAngle;if((0!=e||0!=i)&&o!=r){var h=this.anticlockwise;this.points=[];var a=1/Math.max(e,i);if(h){var l=2*Math.PI;o=l-o,r=l-r}r<o&&(a=-a);for(var p=o;;p+=a){0<a&&r<p?p=r:a<0&&p<r&&(p=r);var c={x:Math.cos(p)*e+s,y:Math.sin(p)*i+n};if(this.points.push(c),p==r)break}return this.points}},void 0!==jmGraph&&(jmGraph.prototype.shapes.arc=jmArc),jmUtils.extend(jmArraw,jmPath),jmUtils.createProperty(jmArraw.prototype,"start"),jmUtils.createProperty(jmArraw.prototype,"end"),jmUtils.createProperty(jmArraw.prototype,"angle"),jmUtils.createProperty(jmArraw.prototype,"offsetX"),jmUtils.createProperty(jmArraw.prototype,"offsetY"),jmArraw.prototype.initPoints=function(t){var e=this.angle,i=this.start,s=this.end;if(s){e||(e=Math.atan2(s.y-i.y,s.x-i.x)),this.points=[];var n=this.offsetX,o=this.offsetY,r=Math.atan2(n,o),h=e+r,a=Math.sin(h),l=Math.cos(h),p=Math.sqrt(n*n+o*o),c=a*p,m=l*p,u={x:s.x-m,y:s.y-c},f=e-r;c=(a=Math.sin(f))*p,m=(l=Math.cos(f))*p;var d={x:s.x-m,y:s.y-c},y=jmUtils.clone(s);return y.m=!0,this.points.push(y),this.points.push(u),t||this.style.fill?(this.points.push(d),this.points.push(s)):(this.points.push(y),this.points.push(d)),this.points}},void 0!==jmGraph&&(jmGraph.prototype.shapes.arraw=jmArraw),jmUtils.extend(jmBezier,jmPath),jmUtils.createProperty(jmBezier.prototype,"cpoints"),jmBezier.prototype.initPoints=function(){this.points=[];for(var t=this.cpoints,e=0;e<=1;e+=.01){var i=this.getPoint(t,e);this.points.push(i)}return this.points.push(t[t.length-1]),this.points},jmBezier.prototype.getPoint=function(t,e){if(1==t.length)return t[0];if(2==t.length)return(n={}).x=(t[1].x-t[0].x)*e+t[0].x,n.y=(t[1].y-t[0].y)*e+t[0].y,n;if(2<t.length){for(var i=[],s=0;s<t.length-1;s++){var n;(n=this.getPoint([t[s],t[s+1]],e))&&i.push(n)}return this.getPoint(i,e)}},jmBezier.prototype.offset=function(t,e,i){var s=this.cpoints;if(s){for(var n=s.length,o=0;o<n;o++)s[o].x+=t,s[o].y+=e;this.emit("move",{offsetX:t,offsetY:e,trans:i}),this.getLocation(!0)}},void 0!==jmGraph&&(jmGraph.prototype.shapes.bezier=jmBezier),jmUtils.extend(jmCircle,jmArc),jmCircle.prototype.initPoints=function(){var t=this.getLocation();t.radius||(t.radius=Math.min(t.width,t.height)/2),this.points=[],this.points.push({x:t.center.x-t.radius,y:t.center.y-t.radius}),this.points.push({x:t.center.x+t.radius,y:t.center.y-t.radius}),this.points.push({x:t.center.x+t.radius,y:t.center.y+t.radius}),this.points.push({x:t.center.x-t.radius,y:t.center.y+t.radius})},jmCircle.prototype.draw=function(){var t=this.parent&&this.parent.absoluteBounds?this.parent.absoluteBounds:this.absoluteBounds,e=this.getLocation();e.radius||(e.radius=Math.min(e.width,e.height)/2);var i=this.startAngle,s=this.endAngle,n=this.anticlockwise;this.context.arc(e.center.x+t.left,e.center.y+t.top,e.radius,i,s,n)},void 0!==jmGraph&&(jmGraph.prototype.shapes.circle=jmCircle),jmUtils.extend(jmHArc,jmPath),jmUtils.createProperty(jmHArc.prototype,"center"),jmUtils.createProperty(jmHArc.prototype,"minRadius"),jmUtils.createProperty(jmHArc.prototype,"maxRadius"),jmUtils.createProperty(jmHArc.prototype,"startAngle",0),jmUtils.createProperty(jmHArc.prototype,"endAngle",2*Math.PI),jmUtils.createProperty(jmHArc.prototype,"anticlockwise",!1),jmHArc.prototype.initPoints=function(){var t=this.getLocation(),e=this.minRadius,i=this.maxRadius,s=this.startAngle,n=this.endAngle;this.anticlockwise&&(s=(m=2*Math.PI)-s,n=m-n);var o=.1;n<s&&(o=-o);for(var r=[],h=[],a=s;!(0<o&&n<=a)&&!(o<0&&a<=n);a+=o){var l=Math.cos(a),p=Math.sin(a),c={x:l*e+t.center.x,y:p*e+t.center.y},m={x:l*i+t.center.x,y:p*i+t.center.y};r.push(c),h.push(m)}h.reverse(),this.style&&this.style.close||(h[0].m=!0),this.points=r.concat(h)},void 0!==jmGraph&&(jmGraph.prototype.shapes.harc=jmHArc),jmUtils.extend(jmLine,jmPath),jmUtils.createProperty(jmLine.prototype,"start"),jmUtils.createProperty(jmLine.prototype,"end"),jmLine.prototype.initPoints=function(){var t=this.start,e=this.end;if(this.points=[],this.points.push(t),"dotted"===this.style.lineType){var i=e.x-t.x,s=e.y-t.y,n=Math.sqrt(i*i+s*s);i/=n,s/=n;for(var o=!1,r=this.style.dashLength||5,h=r/2,a=r;a<=n;)0==o?(this.points.push({x:t.x+i*a,y:t.y+s*a}),a+=h):(this.points.push({x:t.x+i*a,y:t.y+s*a,m:!0}),a+=r),o=!o}return this.points.push(e),this.points},void 0!==jmGraph&&(jmGraph.prototype.shapes.line=jmLine),jmUtils.extend(jmPrismatic,jmPath),jmUtils.createProperty(jmPrismatic.prototype,"center"),jmPrismatic.prototype.initPoints=function(){var t=this.getLocation(),e=t.width/2,i=t.height/2;this.points=[],this.points.push({x:t.center.x-e,y:t.center.y}),this.points.push({x:t.center.x,y:t.center.y+i}),this.points.push({x:t.center.x+e,y:t.center.y}),this.points.push({x:t.center.x,y:t.center.y-i})},void 0!==jmGraph&&(jmGraph.prototype.shapes.prismatic=jmPrismatic),jmUtils.extend(jmRect,jmPath),jmUtils.createProperty(jmRect.prototype,"radius",0),jmRect.prototype.getBounds=function(){var t={};this.initPoints();var e=this.getLocation();return t.left=e.left,t.top=e.top,t.right=e.left+e.width,t.bottom=e.top+e.height,t.width=t.right-t.left,t.height=t.bottom-t.top,t},jmRect.prototype.initPoints=function(){var t=this.getLocation(),e={x:t.left,y:t.top},i={x:t.left+t.width,y:t.top},s={x:t.left+t.width,y:t.top+t.height},n={x:t.left,y:t.top+t.height};if("dotted"!==this.style.lineType||this.dottedLine||(this.dottedLine=this.graph.createShape("line",{style:this.style})),t.radius&&t.radius<t.width/2&&t.radius<t.height/2){var o=Math.PI/2,r=this.graph.createShape("arc",{radius:t.radius,anticlockwise:!1});r.center={x:t.left+t.radius,y:t.top+t.radius},r.startAngle=Math.PI,r.endAngle=Math.PI+o;var h=r.initPoints();(r=this.graph.createShape("arc",{radius:t.radius,anticlockwise:!1})).center={x:i.x-t.radius,y:i.y+t.radius},r.startAngle=Math.PI+o,r.endAngle=2*Math.PI;var a=r.initPoints();(r=this.graph.createShape("arc",{radius:t.radius,anticlockwise:!1})).center={x:s.x-t.radius,y:s.y-t.radius},r.startAngle=0,r.endAngle=o;var l=r.initPoints();(r=this.graph.createShape("arc",{radius:t.radius,anticlockwise:!1})).center={x:n.x+t.radius,y:n.y-t.radius},r.startAngle=o,r.endAngle=Math.PI;var p=r.initPoints();this.points=h.concat(a,l,p)}else this.points=[],this.points.push(e),this.dottedLine&&(this.dottedLine.start=e,this.dottedLine.end=i,this.points=this.points.concat(this.dottedLine.initPoints())),this.points.push(i),this.dottedLine&&(this.dottedLine.start=i,this.dottedLine.end=s,this.points=this.points.concat(this.dottedLine.initPoints())),this.points.push(s),this.dottedLine&&(this.dottedLine.start=s,this.dottedLine.end=n,this.points=this.points.concat(this.dottedLine.initPoints())),this.points.push(n),this.dottedLine&&(this.dottedLine.start=n,this.dottedLine.end=e,this.points=this.points.concat(this.dottedLine.initPoints()));return this.points},void 0!==jmGraph&&(jmGraph.prototype.shapes.rect=jmRect),jmUtils.extend(jmArrawLine,jmPath),jmUtils.createProperty(jmArrawLine.prototype,"end"),jmUtils.createProperty(jmArrawLine.prototype,"start"),jmArrawLine.prototype.initPoints=function(){return this.points=this.line.initPoints(),!1!==this.arrawVisible&&(this.points=this.points.concat(this.arraw.initPoints())),this.points},void 0!==jmGraph&&(jmGraph.prototype.shapes.arrawline=jmArrawLine),jmUtils.extend(jmImage,jmControl),jmUtils.createProperty(jmImage.prototype,"sourcePosition"),jmUtils.createProperty(jmImage.prototype,"sourceWidth"),jmUtils.createProperty(jmImage.prototype,"sourceHeight"),jmUtils.createProperty(jmImage.prototype,"image"),jmImage.prototype.draw=function(){try{var t=this.parent&&this.parent.absoluteBounds?this.parent.absoluteBounds:this.absoluteBounds;t||(t=this.parent&&this.parent.getAbsoluteBounds?this.parent.getAbsoluteBounds():this.getAbsoluteBounds());var e=this.getLocation();e.left+=t.left,e.top+=t.top;var i=this.sourcePosition,s=this.sourceWidth,n=this.sourceHeight,o=this.getImage();i||void 0!==s||void 0!==n?(void 0===s&&(s=e.width||o.width||0),void 0===n&&(n=e.height||o.height||0),i=i||{x:0,y:0},e.width&&e.height?this.context.drawImage(o,i.x,i.y,s,n,e.left,e.top,e.width,e.height):e.width?this.context.drawImage(o,i.x,i.y,s,n,e.left,e.top,e.width,n):e.height?this.context.drawImage(o,i.x,i.y,s,n,e.left,e.top,s,e.height):this.context.drawImage(o,i.x,i.y,s,n,e.left,e.top,s,n)):e?e.width&&e.height?this.context.drawImage(o,e.left,e.top,e.width,e.height):e.width?this.context.drawImage(o,e.left,e.top,e.width,o.height):e.height?this.context.drawImage(o,e.left,e.top,o.width,e.height):this.context.drawImage(o,e.left,e.top):this.context.drawImage(o)}catch(t){console.error&&console.error(t)}},jmImage.prototype.getBounds=function(){var t={},e=this.getImage(),i=this.getLocation(),s=i.width||e.width,n=i.height||e.height;return t.left=i.left,t.top=i.top,t.right=i.left+s,t.bottom=i.top+n,t.width=s,t.height=n,t},jmImage.prototype.getImage=function(){var t=this.image||this.style.src||this.style.image;return this.__img&&this.__img.src&&-1!=this.__img.src.indexOf(t)||(t&&t.src?this.__img=t:document&&document.createElement?(this.__img=document.createElement("img"),t&&"string"==typeof t&&(this.__img.src=t)):this.__img=t),this.__img},void 0!==jmGraph&&(jmGraph.prototype.shapes.image=jmImage),jmUtils.extend(jmLabel,jmControl),jmUtils.createProperty(jmLabel.prototype,"text"),jmLabel.prototype.initPoints=function(){this.__size=null;var t=this.testSize(),e=this.getLocation(),i=e.width||t.width,s=e.height||t.height;return this.points=[{x:e.left,y:e.top}],this.points.push({x:e.left+i,y:e.top}),this.points.push({x:e.left+i,y:e.top+s}),this.points.push({x:e.left,y:e.top+s}),this.points},jmLabel.prototype.testSize=function(){return this.__size||(this.style.font=this.style.fontSize+"px "+this.style.fontFamily,this.context.save(),this.setStyle(),this.__size=this.context.measureText?this.context.measureText(this.text):{width:15},this.context.restore(),this.__size.height=this.style.fontSize?this.style.fontSize:15,this.width||(this.width=this.__size.width),this.height||(this.height=this.__size.height)),this.__size},jmLabel.prototype.draw=function(){var t=this.parent&&this.parent.absoluteBounds?this.parent.absoluteBounds:this.absoluteBounds,e=(this.testSize(),this.getLocation()),i=e.left+t.left,s=e.top+t.top;switch(this.style.textAlign){case"right":i+=e.width;break;case"center":i+=e.width/2}switch(this.style.textBaseline){case"bottom":s+=e.height;break;case"hanging":case"alphabetic":case"middle":s+=e.height/2}var n=this.text;n&&(this.style.fill&&this.context.fillText?this.style.maxWidth?this.context.fillText(n,i,s,this.style.maxWidth):this.context.fillText(n,i,s):this.context.strokeText&&(this.style.maxWidth?this.context.strokeText(n,i,s,this.style.maxWidth):this.context.strokeText(n,i,s))),this.style.border&&(this.style.border.style&&(this.context.save(),this.setStyle(this.style.border.style)),this.context.moveTo(this.points[0].x+t.left,this.points[0].y+t.top),this.style.border.top&&this.context.lineTo(this.points[1].x+t.left,this.points[1].y+t.top),this.style.border.right&&(this.context.moveTo(this.points[1].x+t.left,this.points[1].y+t.top),this.context.lineTo(this.points[2].x+t.left,this.points[2].y+t.top)),this.style.border.bottom&&(this.context.moveTo(this.points[2].x+t.left,this.points[2].y+t.top),this.context.lineTo(this.points[3].x+t.left,this.points[3].y+t.top)),this.style.border.left&&(this.context.moveTo(this.points[3].x+t.left,this.points[3].y+t.top),this.context.lineTo(this.points[0].x+t.left,this.points[0].y+t.top)),this.style.border.style&&this.context.restore())},void 0!==jmGraph&&(jmGraph.prototype.shapes.label=jmLabel),jmUtils.extend(jmResize,jmRect),jmUtils.createProperty(jmResize.prototype,"rectSize",8),jmResize.prototype.init=function(){if(!1!==this.params.resizable){this.resizeRects=[];var t=this.rectSize,e=this.style.rectStyle||{stroke:"red",fill:"transparent",lineWidth:2,close:!0,zIndex:100};e.close=!0,e.fill=e.fill||"transparent";for(var i=0;i<8;i++){var s=this.graph.createShape("rect",{position:{x:0,y:0},width:t,height:t,style:e});s.index=i,s.visible=!0,this.resizeRects.push(s),this.children.add(s),s.canMove(!0,this.graph)}this.reset(0,0,0,0),this.bindRectEvents()}},jmResize.prototype.bindRectEvents=function(){for(var t=0;t<this.resizeRects.length;t++){var e=this.resizeRects[t];e.on("move",function(t){var e=0,i=0,s=0,n=0;0==this.index?(s=-t.offsetX,e=t.offsetX):1==this.index?(s=-t.offsetX,e=t.offsetX,n=-t.offsetY,i=t.offsetY):2==this.index?(n=-t.offsetY,i=t.offsetY):3==this.index?(s=t.offsetX,n=-t.offsetY,i=t.offsetY):4==this.index?s=t.offsetX:5==this.index?(s=t.offsetX,n=t.offsetY):6==this.index?n=t.offsetY:7==this.index&&(s=-t.offsetX,s=-t.offsetX,e=t.offsetX,n=t.offsetY),this.parent.reset(e,i,s,n)}),e.bind("mousemove",function(){this.cursor(["w-resize","nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize"][this.index])}),e.bind("mouseleave",function(){this.cursor("default")})}},jmResize.prototype.reset=function(t,e,i,s){var n=void 0===this.style.minWidth?5:this.style.minWidth,o=void 0===this.style.minHeight?5:this.style.minHeight,r=this.getLocation();if(0!=i||0!=s){var h=r.width+i,a=r.height+s;if(n<=h||o<=a){if(n<=h?this.width=h:i=t=0,o<=a?this.height=a:s=e=0,!1!==this.params.movable&&(t||e)){var l=this.position;l.x=r.left+t,l.y=r.top+e,this.position=l}this.emit("resize",t,e,i,s)}}for(var p in this.resizeRects){var c=this.resizeRects[p];switch(c.index){case 0:c.position.x=-c.width/2,c.position.y=(r.height-c.height)/2;break;case 1:c.position.x=-c.width/2,c.position.y=-c.height/2;break;case 2:c.position.x=(r.width-c.width)/2,c.position.y=-c.height/2;break;case 3:c.position.x=r.width-c.width/2,c.position.y=-c.height/2;break;case 4:c.position.x=r.width-c.width/2,c.position.y=(r.height-c.height)/2;break;case 5:c.position.x=r.width-c.width/2,c.position.y=r.height-c.height/2;break;case 6:c.position.x=(r.width-c.height)/2,c.position.y=r.height-c.height/2;break;case 7:c.position.x=-c.width/2,c.position.y=r.height-c.height/2}}},void 0!==jmGraph&&(jmGraph.prototype.shapes.resize=jmResize);